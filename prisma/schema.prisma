generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// ─────────────────────────────
///    USER (Authenticated only)
///    ─────────────────────────────
model User {
  id          String       @id @default(cuid())
  email       String       @unique
  username    String?
  fullName    String?
  phone       String?
  loyaltyType LoyaltyType?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  bookings    Booking[]
}

/// ─────────────────────────────
///    BOOKING
///    ─────────────────────────────
model Booking {
  id         String           @id @default(cuid())
  type       BookingType
  status     BookingStatus    @default(PENDING)
  date       DateTime
  time       String
  totalPrice Int
  /// Guest booking fields
  fullName   String?
  email      String?
  phone      String?
  /// Authenticated user
  userId     String?
  createdAt  DateTime         @default(now())
  updatedAt  DateTime         @updatedAt
  user       User?            @relation(fields: [userId], references: [id])
  services   BookingService[]
}

/// ─────────────────────────────
///    BOOKING SERVICES (Join Table)
///    ─────────────────────────────
model BookingService {
  id        String   @id @default(cuid())
  bookingId String
  name      String
  price     Int
  createdAt DateTime @default(now())
  booking   Booking  @relation(fields: [bookingId], references: [id], onDelete: Cascade)
}

/// ─────────────────────────────
///    ENUMS
///    ─────────────────────────────
enum BookingType {
  NORMAL
  VIP
  HOME
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

enum LoyaltyType {
  VIP_5
  VIP_10
}
